var structureJS="undefined"!=typeof structureJS?structureJS:{options:{log:!0,max_log_level:3,log_off_in_production:!0,download_minified:!1,minified_output_tag_id:"minified"},config:{structureJS_base:"structureJS/",module_base:"Modules/",global_base:"lib/",globals:[],commons:[]},uglifyMode:!1,compressedMode:!1,_needTree:{},_files:[],_exportOrder:[],_modules:{},_cache:{},UGLYFY_FILENAME:"uglifyjs.min",COMPRESSION_FILENAME:"structureJSCompress",cache:function(e,t){var n=null;return 1==arguments.length&&this._cache[e]&&(n=this._cache[e]),2==arguments.length&&e&&t&&(this._cache[e]=t),n},resolveFilePath:function(e){function t(e,t){var o=n.directory_aliases,i=t+e+".js";if("undefined"==typeof o)return i;var r=null,l=null;for(var s in o)l=new RegExp("^"+s+"/","i"),r=l.exec(e),null!=r&&(i=e.replace(r[0],o[s])+".js");return i}var n=this.config,o="";return e&&"object"==typeof e?o=t(Object.keys(e)[0],n.module_base):e==this.UGLYFY_FILENAME||e==this.COMPRESSION_FILENAME?o=t(e,n.structureJS_base):"string"==typeof e&&(o=t(e,n.global_base)),o},loadScript:function(e,t){var n=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.src=e,n.appendChild(o),o.onload=t},loadModules:function(){for(var e=this,t=e.config.globals||[],n=e.config.commons||[],o=n.length-1;o>=0;o--){var i={};i[n[o]]=null,e._files.unshift(i)}1==e.uglifyMode&&t.unshift("uglifyjs.min"),e._files=t.concat(e._files);for(var o=0;o<e._files.length;o++)e._exportOrder.push(e.resolveFilePath(e._files[o]));var r=function(){var t=e.resolveFilePath(e._files.shift());t?(console.logf(1,"Loading: %s",t),e.loadScript(t,r)):1==e.uglifyMode?e.loadScript(e.resolveFilePath("structureJSCompress"),function(){console.log(1,"Modules Done Loading. Enjoy structureJS!")}):console.log(1,"Modules Done Loading. Enjoy structureJS!")};e.loadScript(this.resolveFilePath(e._files.shift()),r)},detectCircularDependency:function(e){var t="",n="",o="";for(var t in e){console.logf(3,"Checking %s's dependencies",t);for(var i=0;i<e[t].length;i++){if(n=e[t][i],console.logf(3,"Dependency %s of %s is %s",i,t,n),"undefined"==typeof e[n])throw"ERROR: "+n+" is a dependency of "+t+" but has not been explicitly declared.";for(var r=0;r<e[n].length;r++)if(o=e[n][r],console.logf(3,"Checking %s's dependencies for circular reference to parent %s",n,t),t==o)throw"ERROR: CIRCULAR DEPENDENCY: "+t+" is a dependency of its own dependency "+n}}return!1},orderImports:function(e){function t(e){return Object.keys(e)[0]}function n(e){for(var n=e||"",o=0;o<s.length;o++)n+=t(s[o])+",";console.log(2,n)}function o(t){return e[t]}function i(e){for(var n=0;n<s.length;n++)if(e===t(s[n]))return n}function r(e){for(var n=0;n<s.length;n++)if(e===t(s[n]))return s[n]}function l(e,n){var o=i(t(e)),l=(r(t(s[n])),t(s[n]));console.log("Moving "+t(e)+"("+o+") in front of "+l+"("+n+")");for(var u=[],f=0;f<s.length;f++)n>f?u.push(s[f]):f==n?u.push(e):f>n&&u.push(s[f-1]);s=u}var s=[];for(var u in e){var f={};f[u]=e[u],s.push(f)}n("Starting Order: ",s);for(var c=0,a="",d=null,g="",p=0;p<s.length;p++){a=t(s[p]),c=i(a),d=o(a),console.logf("Resolving: %s, Index: %s",a,p);for(var u=0;u<d.length;u++)g=d[u],a!==g&&i(g)>c&&l(r(g),i(a))}return s},declare:function(e,t){"undefined"==typeof t&&(t=[]),this._needTree[e]=t},resolveDependencies:function(){function e(e,t){function n(e){return Object.keys(e)[0]}for(var o=e||"",i=0;i<t.length;i++)o+=n(t[i])+",";console.log(2,o)}this.detectCircularDependency(this._needTree),this._files=this.orderImports(this._needTree,this._files),e("Resolved Order: ",this._files),this.loadModules(this.config)},module:function(e,t){function n(e){return o._modules[e].module}if("undefined"==typeof e||"function"==typeof e)throw"Module Must Have Configuration Object Or Name String";if("function"!=typeof t)throw"Module Must Have A Function As It's Definition";var o=this,i=null,r={type:"unknown"};if("string"==typeof e)i=e;else if("object"==typeof e){if("undefined"==typeof e.name)throw"Module Configuration Object Must Have Name Property";i=e.name,"undefined"!=typeof e.type&&(r.type=e.type)}if(n.amd=n,n._class=n,structureJS.require=n,n.getType=function(e){return o._modules[e].type},r.module=t.call(null,n),"undefined"==typeof r.module)throw i+" FAILED: Module Function Definition Must Return Something";this._modules[i]=r},moduleAMD:function(e,t){var n={type:"amd",name:e};if(n.module=t.call(null).call(null),"undefined"==typeof n.module)throw"Module Function Definition Must Return Something";console.logf(2,"AMD: Loading %s",e),this._modules[e]=n},loadConfigAndManifest:function(e){var t=document.getElementById("structureJS");if("undefined"==typeof t||null===t)throw'ERROR: No script tag with ID of "structureJS" which is required';var n=t.getAttribute("data-config"),o=t.getAttribute("data-manifest"),i=t.getAttribute("data-uglify"),r=this.config.structureJS_base;if("undefined"==typeof o||""===o||null===o)throw"ERROR: No manifest declared";"undefined"!=typeof i&&null===i||1!=/true/i.test(i)||(this.uglifyMode=!0);var l=this,s=function(){null!=o?(console.logf(2,"Loading Manifest: %s%s",r,o),l.loadScript(r+o+".js",s),o=null):(console.log(2,"Done Loading Manifest And/Or Config Files."),e.call(l))};n?(console.logf(2,"Loading Config: %s%s",r,n),this.loadScript(r+n+".js",s)):this.loadScript(r+o+".js",function(){e.call(l)})},printf:function(e){arguments=e;var t="",n=0,o=null;if(arguments.length>1&&"string"==typeof arguments[1]){var i=arguments[1];e=Array.prototype.slice.call(arguments,0),e=e.splice(2,arguments.length-1),t+=i.replace(/%s/g,function(){return n<e.length?e[n++]:"%s"}),o=t}else o=e[0];return o}};!function(e){var t=document.getElementById("structureJS");if("undefined"==typeof t||null===t)throw'ERROR: No script tag with ID of "structureJS" which is required';if(e.console&&0!=structureJS.options.log||(e.console={log:function(){},logf:function(){}}),e.console&&structureJS.options.log&&structureJS.options.max_log_level>0){var n=e.console.log;e.console.log=function(t,o){2==arguments.length&&t<=structureJS.options.max_log_level&&n.apply(e.console,[o])},e.console.logf=function(t){var t=arguments[0];arguments.length>2&&"number"==typeof t&&t<=structureJS.options.max_log_level&&n.apply(e.console,[structureJS.printf(arguments)])}}var o=t.getAttribute("data-is-combined");"undefined"!=typeof o&&null!==o&&1==/true/i.test(o)?1==structureJS.options.log_off_in_production&&(structureJS.options.max_log_level=0):structureJS.loadConfigAndManifest(structureJS.resolveDependencies),e.define=function(t,n,o){e.structureJS.moduleAMD(t,o)},e.define.amd={jQuery:!0}}(window);structureJS.module("C",function(){return console.log("Hello From C"),structureJS.cache("test",{onnoze:"oh yeah!"}),{blasted:"whoooooaaaa"}});structureJS.module("D",function(e){e("C");return console.log(1,structureJS.cache("test")),setTimeout(function(){console.log(1,structureJS.cache("test")),document.getElementById("test").innerText="D is loaded"},1500),{}});